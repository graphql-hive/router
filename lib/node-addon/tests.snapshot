exports[`should plan simple query 1`] = `
{
  "kind": "QueryPlan",
  "node": {
    "kind": "Sequence",
    "nodes": [
      {
        "kind": "Parallel",
        "nodes": [
          {
            "kind": "Fetch",
            "operation": "query{topProducts{__typename upc name price weight}}",
            "operationDocumentNode": {
              "definitions": [
                {
                  "kind": "OperationDefinition",
                  "operation": "query",
                  "selectionSet": {
                    "kind": "SelectionSet",
                    "selections": [
                      {
                        "kind": "Field",
                        "name": {
                          "kind": "Name",
                          "value": "topProducts"
                        },
                        "selectionSet": {
                          "kind": "SelectionSet",
                          "selections": [
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "__typename"
                              }
                            },
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "upc"
                              }
                            },
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "name"
                              }
                            },
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "price"
                              }
                            },
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "weight"
                              }
                            }
                          ]
                        }
                      }
                    ]
                  }
                }
              ],
              "kind": "Document"
            },
            "operationKind": "query",
            "serviceName": "products"
          },
          {
            "kind": "Fetch",
            "operation": "query{users{__typename id username name}}",
            "operationDocumentNode": {
              "definitions": [
                {
                  "kind": "OperationDefinition",
                  "operation": "query",
                  "selectionSet": {
                    "kind": "SelectionSet",
                    "selections": [
                      {
                        "kind": "Field",
                        "name": {
                          "kind": "Name",
                          "value": "users"
                        },
                        "selectionSet": {
                          "kind": "SelectionSet",
                          "selections": [
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "__typename"
                              }
                            },
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "id"
                              }
                            },
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "username"
                              }
                            },
                            {
                              "kind": "Field",
                              "name": {
                                "kind": "Name",
                                "value": "name"
                              }
                            }
                          ]
                        }
                      }
                    ]
                  }
                }
              ],
              "kind": "Document"
            },
            "operationKind": "query",
            "serviceName": "accounts"
          }
        ]
      },
      {
        "kind": "Parallel",
        "nodes": [
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{shippingEstimate inStock}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "shippingEstimate"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "inStock"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "price"
                    },
                    {
                      "kind": "Field",
                      "name": "weight"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "inventory"
            },
            "path": [
              {
                "Field": "topProducts"
              },
              "@"
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{reviews{id body author{__typename id reviews{id body product{__typename upc}} username}}}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "reviews"
                                      },
                                      "selectionSet": {
                                        "kind": "SelectionSet",
                                        "selections": [
                                          {
                                            "kind": "Field",
                                            "name": {
                                              "kind": "Name",
                                              "value": "id"
                                            }
                                          },
                                          {
                                            "kind": "Field",
                                            "name": {
                                              "kind": "Name",
                                              "value": "body"
                                            }
                                          },
                                          {
                                            "kind": "Field",
                                            "name": {
                                              "kind": "Name",
                                              "value": "author"
                                            },
                                            "selectionSet": {
                                              "kind": "SelectionSet",
                                              "selections": [
                                                {
                                                  "kind": "Field",
                                                  "name": {
                                                    "kind": "Name",
                                                    "value": "__typename"
                                                  }
                                                },
                                                {
                                                  "kind": "Field",
                                                  "name": {
                                                    "kind": "Name",
                                                    "value": "id"
                                                  }
                                                },
                                                {
                                                  "kind": "Field",
                                                  "name": {
                                                    "kind": "Name",
                                                    "value": "reviews"
                                                  },
                                                  "selectionSet": {
                                                    "kind": "SelectionSet",
                                                    "selections": [
                                                      {
                                                        "kind": "Field",
                                                        "name": {
                                                          "kind": "Name",
                                                          "value": "id"
                                                        }
                                                      },
                                                      {
                                                        "kind": "Field",
                                                        "name": {
                                                          "kind": "Name",
                                                          "value": "body"
                                                        }
                                                      },
                                                      {
                                                        "kind": "Field",
                                                        "name": {
                                                          "kind": "Name",
                                                          "value": "product"
                                                        },
                                                        "selectionSet": {
                                                          "kind": "SelectionSet",
                                                          "selections": [
                                                            {
                                                              "kind": "Field",
                                                              "name": {
                                                                "kind": "Name",
                                                                "value": "__typename"
                                                              }
                                                            },
                                                            {
                                                              "kind": "Field",
                                                              "name": {
                                                                "kind": "Name",
                                                                "value": "upc"
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    ]
                                                  }
                                                },
                                                {
                                                  "kind": "Field",
                                                  "name": {
                                                    "kind": "Name",
                                                    "value": "username"
                                                  }
                                                }
                                              ]
                                            }
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "reviews"
            },
            "path": [
              {
                "Field": "topProducts"
              },
              "@"
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on User{reviews{id body product{__typename upc reviews{id body author{__typename id reviews{id body product{__typename upc}} username}}}}}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "reviews"
                                      },
                                      "selectionSet": {
                                        "kind": "SelectionSet",
                                        "selections": [
                                          {
                                            "kind": "Field",
                                            "name": {
                                              "kind": "Name",
                                              "value": "id"
                                            }
                                          },
                                          {
                                            "kind": "Field",
                                            "name": {
                                              "kind": "Name",
                                              "value": "body"
                                            }
                                          },
                                          {
                                            "kind": "Field",
                                            "name": {
                                              "kind": "Name",
                                              "value": "product"
                                            },
                                            "selectionSet": {
                                              "kind": "SelectionSet",
                                              "selections": [
                                                {
                                                  "kind": "Field",
                                                  "name": {
                                                    "kind": "Name",
                                                    "value": "__typename"
                                                  }
                                                },
                                                {
                                                  "kind": "Field",
                                                  "name": {
                                                    "kind": "Name",
                                                    "value": "upc"
                                                  }
                                                },
                                                {
                                                  "kind": "Field",
                                                  "name": {
                                                    "kind": "Name",
                                                    "value": "reviews"
                                                  },
                                                  "selectionSet": {
                                                    "kind": "SelectionSet",
                                                    "selections": [
                                                      {
                                                        "kind": "Field",
                                                        "name": {
                                                          "kind": "Name",
                                                          "value": "id"
                                                        }
                                                      },
                                                      {
                                                        "kind": "Field",
                                                        "name": {
                                                          "kind": "Name",
                                                          "value": "body"
                                                        }
                                                      },
                                                      {
                                                        "kind": "Field",
                                                        "name": {
                                                          "kind": "Name",
                                                          "value": "author"
                                                        },
                                                        "selectionSet": {
                                                          "kind": "SelectionSet",
                                                          "selections": [
                                                            {
                                                              "kind": "Field",
                                                              "name": {
                                                                "kind": "Name",
                                                                "value": "__typename"
                                                              }
                                                            },
                                                            {
                                                              "kind": "Field",
                                                              "name": {
                                                                "kind": "Name",
                                                                "value": "id"
                                                              }
                                                            },
                                                            {
                                                              "kind": "Field",
                                                              "name": {
                                                                "kind": "Name",
                                                                "value": "reviews"
                                                              },
                                                              "selectionSet": {
                                                                "kind": "SelectionSet",
                                                                "selections": [
                                                                  {
                                                                    "kind": "Field",
                                                                    "name": {
                                                                      "kind": "Name",
                                                                      "value": "id"
                                                                    }
                                                                  },
                                                                  {
                                                                    "kind": "Field",
                                                                    "name": {
                                                                      "kind": "Name",
                                                                      "value": "body"
                                                                    }
                                                                  },
                                                                  {
                                                                    "kind": "Field",
                                                                    "name": {
                                                                      "kind": "Name",
                                                                      "value": "product"
                                                                    },
                                                                    "selectionSet": {
                                                                      "kind": "SelectionSet",
                                                                      "selections": [
                                                                        {
                                                                          "kind": "Field",
                                                                          "name": {
                                                                            "kind": "Name",
                                                                            "value": "__typename"
                                                                          }
                                                                        },
                                                                        {
                                                                          "kind": "Field",
                                                                          "name": {
                                                                            "kind": "Name",
                                                                            "value": "upc"
                                                                          }
                                                                        }
                                                                      ]
                                                                    }
                                                                  }
                                                                ]
                                                              }
                                                            },
                                                            {
                                                              "kind": "Field",
                                                              "name": {
                                                                "kind": "Name",
                                                                "value": "username"
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            }
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "User"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "id"
                    }
                  ],
                  "typeCondition": "User"
                }
              ],
              "serviceName": "reviews"
            },
            "path": [
              {
                "Field": "users"
              },
              "@"
            ]
          }
        ]
      },
      {
        "kind": "Parallel",
        "nodes": [
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{price weight name}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "price"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "weight"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "name"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "products"
            },
            "path": [
              {
                "Field": "topProducts"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "author"
              },
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              }
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on User{name}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "name"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "User"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "id"
                    }
                  ],
                  "typeCondition": "User"
                }
              ],
              "serviceName": "accounts"
            },
            "path": [
              {
                "Field": "topProducts"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "author"
              }
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{price weight name}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "price"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "weight"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "name"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "products"
            },
            "path": [
              {
                "Field": "users"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              }
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{price weight name}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "price"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "weight"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "name"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "products"
            },
            "path": [
              {
                "Field": "users"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              },
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "author"
              },
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              }
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on User{name}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "name"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "User"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "id"
                    }
                  ],
                  "typeCondition": "User"
                }
              ],
              "serviceName": "accounts"
            },
            "path": [
              {
                "Field": "users"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              },
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "author"
              }
            ]
          }
        ]
      },
      {
        "kind": "Parallel",
        "nodes": [
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{inStock shippingEstimate}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "inStock"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "shippingEstimate"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    },
                    {
                      "kind": "Field",
                      "name": "price"
                    },
                    {
                      "kind": "Field",
                      "name": "weight"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "inventory"
            },
            "path": [
              {
                "Field": "topProducts"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "author"
              },
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              }
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{inStock shippingEstimate}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "inStock"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "shippingEstimate"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    },
                    {
                      "kind": "Field",
                      "name": "price"
                    },
                    {
                      "kind": "Field",
                      "name": "weight"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "inventory"
            },
            "path": [
              {
                "Field": "users"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              }
            ]
          },
          {
            "kind": "Flatten",
            "node": {
              "kind": "Fetch",
              "operation": "query($representations:[_Any!]!){_entities(representations: $representations){...on Product{inStock shippingEstimate}}}",
              "operationDocumentNode": {
                "definitions": [
                  {
                    "kind": "OperationDefinition",
                    "operation": "query",
                    "selectionSet": {
                      "kind": "SelectionSet",
                      "selections": [
                        {
                          "arguments": [
                            {
                              "kind": "Argument",
                              "name": {
                                "kind": "Name",
                                "value": "representations"
                              },
                              "value": {
                                "kind": "Variable",
                                "name": {
                                  "kind": "Name",
                                  "value": "representations"
                                }
                              }
                            }
                          ],
                          "kind": "Field",
                          "name": {
                            "kind": "Name",
                            "value": "_entities"
                          },
                          "selectionSet": {
                            "kind": "SelectionSet",
                            "selections": [
                              {
                                "kind": "InlineFragment",
                                "selectionSet": {
                                  "kind": "SelectionSet",
                                  "selections": [
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "inStock"
                                      }
                                    },
                                    {
                                      "kind": "Field",
                                      "name": {
                                        "kind": "Name",
                                        "value": "shippingEstimate"
                                      }
                                    }
                                  ]
                                },
                                "typeCondition": {
                                  "kind": "NamedType",
                                  "name": {
                                    "kind": "Name",
                                    "value": "Product"
                                  }
                                }
                              }
                            ]
                          }
                        }
                      ]
                    },
                    "variableDefinitions": [
                      {
                        "kind": "VariableDefinition",
                        "type": {
                          "kind": "NonNullType",
                          "type": {
                            "kind": "ListType",
                            "type": {
                              "kind": "NonNullType",
                              "type": {
                                "kind": "NamedType",
                                "name": {
                                  "kind": "Name",
                                  "value": "_Any"
                                }
                              }
                            }
                          }
                        },
                        "variable": {
                          "kind": "Variable",
                          "name": {
                            "kind": "Name",
                            "value": "representations"
                          }
                        }
                      }
                    ]
                  }
                ],
                "kind": "Document"
              },
              "operationKind": "query",
              "requires": [
                {
                  "kind": "InlineFragment",
                  "selections": [
                    {
                      "kind": "Field",
                      "name": "__typename"
                    },
                    {
                      "kind": "Field",
                      "name": "upc"
                    },
                    {
                      "kind": "Field",
                      "name": "price"
                    },
                    {
                      "kind": "Field",
                      "name": "weight"
                    }
                  ],
                  "typeCondition": "Product"
                }
              ],
              "serviceName": "inventory"
            },
            "path": [
              {
                "Field": "users"
              },
              "@",
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              },
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "author"
              },
              {
                "Field": "reviews"
              },
              "@",
              {
                "Field": "product"
              }
            ]
          }
        ]
      }
    ]
  }
}
`;
